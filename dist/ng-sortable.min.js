!function(){"use strict";angular.module("as.sortable",[]).constant("sortableConfig",{itemClass:"as-sortable-item",handleClass:"as-sortable-item-handle",placeHolderClass:"as-sortable-placeholder",dragClass:"as-sortable-drag",hiddenClass:"as-sortable-hidden",dragging:"as-sortable-dragging",selectedClass:"as-sortable-selected"})}(),function(){"use strict";var mainModule=angular.module("as.sortable");mainModule.factory("$helper",["$document","$window","$timeout",function($document,$window,$timeout){return{height:function(element){return element[0].getBoundingClientRect().height},width:function(element){return element[0].getBoundingClientRect().width},offset:function(element,scrollableContainer){var boundingClientRect=element[0].getBoundingClientRect();return scrollableContainer||(scrollableContainer=$document[0].documentElement),{width:boundingClientRect.width||element.prop("offsetWidth"),height:boundingClientRect.height||element.prop("offsetHeight"),top:boundingClientRect.top+($window.pageYOffset||scrollableContainer.scrollTop-scrollableContainer.offsetTop),left:boundingClientRect.left+($window.pageXOffset||scrollableContainer.scrollLeft-scrollableContainer.offsetLeft)}},eventObj:function(event){var obj=event;return void 0!==event.targetTouches?obj=event.targetTouches.item(0):void 0!==event.originalEvent&&void 0!==event.originalEvent.targetTouches&&(obj=event.originalEvent.targetTouches.item(0)),obj},isTouchInvalid:function(event){var touchInvalid=!1;return void 0!==event.touches&&event.touches.length>1?touchInvalid=!0:void 0!==event.originalEvent&&void 0!==event.originalEvent.touches&&event.originalEvent.touches.length>1&&(touchInvalid=!0),touchInvalid},positionStarted:function(event,target,scrollableContainer){var pos={};return pos.offsetX=event.pageX-this.offset(target,scrollableContainer).left,pos.offsetY=event.pageY-this.offset(target,scrollableContainer).top,pos.startX=pos.lastX=event.pageX,pos.startY=pos.lastY=event.pageY,pos.nowX=pos.nowY=pos.distX=pos.distY=pos.dirAx=0,pos.dirX=pos.dirY=pos.lastDirX=pos.lastDirY=pos.distAxX=pos.distAxY=0,pos},calculatePosition:function(pos,event){pos.lastX=pos.nowX,pos.lastY=pos.nowY,pos.nowX=event.pageX,pos.nowY=event.pageY,pos.distX=pos.nowX-pos.lastX,pos.distY=pos.nowY-pos.lastY,pos.lastDirX=pos.dirX,pos.lastDirY=pos.dirY,pos.dirX=0===pos.distX?0:pos.distX>0?1:-1,pos.dirY=0===pos.distY?0:pos.distY>0?1:-1;var newAx=Math.abs(pos.distX)>Math.abs(pos.distY)?1:0;pos.dirAx!==newAx?(pos.distAxX=0,pos.distAxY=0):(pos.distAxX+=Math.abs(pos.distX),0!==pos.dirX&&pos.dirX!==pos.lastDirX&&(pos.distAxX=0),pos.distAxY+=Math.abs(pos.distY),0!==pos.dirY&&pos.dirY!==pos.lastDirY&&(pos.distAxY=0)),pos.dirAx=newAx},movePosition:function(event,element,pos,container,containerPositioning,scrollableContainer){var bounds,useRelative="relative"===containerPositioning;element.x=event.pageX-pos.offsetX,element.y=event.pageY-pos.offsetY,container&&(bounds=this.offset(container,scrollableContainer),useRelative&&(element.x-=bounds.left,element.y-=bounds.top,bounds.left=0,bounds.top=0),element.x<bounds.left?element.x=bounds.left:element.x>=bounds.width+bounds.left-this.offset(element).width&&(element.x=bounds.width+bounds.left-this.offset(element).width),element.y<bounds.top?element.y=bounds.top:element.y>=bounds.height+bounds.top-this.offset(element).height&&(element.y=bounds.height+bounds.top-this.offset(element).height)),element.css({left:element.x+"px",top:element.y+"px"}),this.calculatePosition(pos,event)},allSameParents:function(sources){for(var allSame=!0,currentParentElement=sources[0].sortableScope.element,i=1;i<sources.length;i++)if(sources[i].sortableScope.element!==currentParentElement){allSame=!1;break}return allSame},getBetweenScopes:function(parentElement,querySelector,start,end){for(var childElements=Array.prototype.slice.call(parentElement.querySelectorAll(querySelector)),betweenElements=childElements.slice(start,end+1),childScopes=[],i=0;i<betweenElements.length;i++){var betweenElement=angular.element(betweenElements[i]),fetchScope=this.fetchScope(betweenElement);childScopes.push(fetchScope)}return childScopes},findMaxMinIndex:function(itemScopes){for(var returnObject={max:itemScopes[0].index(),min:itemScopes[0].index()},i=1;i<itemScopes.length;i++){var index=itemScopes[i].index();returnObject.max<index&&(returnObject.max=index),returnObject.min>index&&(returnObject.min=index)}return returnObject},dragItems:function(items){return{index:null,parent:null,sources:items,isSameParent:function(source){return this.parent?this.parent.element===source.sortableScope.element:!0},allSameParent:function(){for(var allSame=!0,i=0;i<this.sources.length;i++){var source=this.sources[i];if(!this.isSameParent(source)){allSame=!1;break}}return allSame},isOrderChanged:function(){var allSame=!0;if(null===this.index)return!1;for(var i=0;i<this.sources.length;i++){var source=this.sources[i];if(this.index!==source.index()){allSame=!1;break}}return!allSame},moveTo:function(parent,index){this.parent=parent;for(var numberOfSelectedBefore=0,i=0;i<this.sources.length;i++){var source=this.sources[i];this.isSameParent(source)&&source.index()<index&&!source.sortableScope.cloning&&numberOfSelectedBefore++}index-=numberOfSelectedBefore,this.index=index},apply:function(){var i,source;for(i=0;i<this.sources.length;i++)source=this.sources[i],source.sortableScope.cloning||source.sortableScope.removeItem(source.modelValue);for(i=0;i<this.sources.length;i++){source=this.sources[i];var parent=this.parent?this.parent:source.sortableScope,index=null===this.index?source.index():this.index+i;source.sortableScope.cloning?parent.options.clone||parent.insertItem(index,angular.copy(source.modelValue)):(parent.options.allowDuplicates||parent.modelValue.indexOf(source.modelValue)<0)&&parent.insertItem(index,source.modelValue)}},eventArgs:function(){for(var self=this,sourcesInfo=[],i=0;i<this.sources.length;i++){var source=this.sources[i];sourcesInfo.push({scope:source,index:source.index(),parentScope:source.sortableScope})}var dest={scope:self.parent,index:self.index};return{sourcesInfo:sourcesInfo,dest:dest}}}},noDrag:function(element){return void 0!==element.attr("no-drag")||void 0!==element.attr("data-no-drag")},findAncestor:function(el,selector){for(var matches=Element.matches||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector;(el=el.parentElement)&&!matches.call(el,selector););return el?angular.element(el):angular.element(document.body)},fetchScope:function(element,skipClass){for(var scope;!scope&&element.length;)skipClass&&element.hasClass(skipClass)||(scope=element.data("_scope")),scope||(element=element.parent());return scope},orderSelected:function(selected){selected.sort(function(selectedA,selectedB){var a=selectedA.overAllIndex(),b=selectedB.overAllIndex();return a.row>b.row?1:a.row<b.row?-1:a.column>=b.column?1:-1})},isSelected:function(selected,itemScope,hashKey){var index=selected.indexOf(itemScope);if(-1===index){if(void 0===hashKey)return!1;for(var i=0;i<selected.length;i++)if(selected[i].modelValue.$$hashKey===hashKey){index=i,selected[index]=itemScope,this.orderSelected(selected);break}return-1!==index}return!0},isCloning:function(selected,shift){return selected.sortableScope.cloning=selected.sortableScope.options.clone||selected.sortableScope.options.ctrlClone&&shift,selected.sortableScope.cloning},isParent:function(possibleParent,elem){return elem&&"HTML"!==elem.nodeName?elem.parentNode===possibleParent?!0:this.isParent(possibleParent,elem.parentNode):!1},debounceCall:function(){var timeouts={};return function(signature,func,params,timeout){timeouts[signature]&&$timeout.cancel(timeouts[signature]);var promise=$timeout(function(){func.call({},params)},timeout);timeouts[signature]=promise}}()}}])}(),function(){"use strict";var mainModule=angular.module("as.sortable");mainModule.factory("SortableEventBus",[function(){function SortableEventBus(events){this.eventBus={};for(var i=0;i<events.length;i++){var eventName=events[i];this.eventBus[eventName]=[]}}return SortableEventBus.prototype={on:function(eventName,callback){this.eventBus[eventName]=this.eventBus[eventName]||[],this.eventBus[eventName].push(callback)},fire:function(eventName,args){var callbacks=this.eventBus[eventName];if(callbacks&&!(callbacks.length<1)){for(var results=[],i=0;i<callbacks.length;i++){var result=callbacks[i].apply({},args);results.push(result)}return results}}},SortableEventBus}])}(),function(){"use strict";var mainModule=angular.module("as.sortable");mainModule.directive("asSortableGroup",function(){return{restrict:"A",controller:"as.sortable.sortableGroupController",scope:!0,link:function(scope,element,attrs){function initiateEventBus(eventBus){eventBus.on("deselectAll",function(){scope.removeAllFromSelected()}),eventBus.on("deselect",function(index){}),eventBus.on("getSelected",function(){return scope.selected}),eventBus.on("getIsDragging",function(){return scope.dragging})}scope.options={};var callbacks,pointerUpCallback=function(e){e.ctrlKey||e.metaKey||e.shiftKey||scope.dragging||scope.$apply(function(){scope.removeAllFromSelected()})};window.PointerEvent?window.addEventListener("pointerup",pointerUpCallback,!0):window.addEventListener("touchend",pointerUpCallback,!0),scope.$on("$destroy",function(){window.removeEventListener("pointerup",pointerUpCallback),window.removeEventListener("touchend",pointerUpCallback)}),callbacks={orderChanged:null,itemMoved:null,dragStart:null,dragMove:null,dragCancel:null,dragEnd:null,selectionChanged:null},callbacks.orderChanged=function(event){},callbacks.itemMoved=function(event){},callbacks.dragStart=function(event){},callbacks.dragMove=angular.noop,callbacks.dragCancel=function(event){},callbacks.dragEnd=function(event){},callbacks.selectionChanged=function(event){};var initiatedEventBus=!1;scope.$watch(attrs.asSortableGroup,function(newVal,oldVal){angular.forEach(newVal,function(value,key){"eventBus"===key?null===value||initiatedEventBus||(initiateEventBus(value),initiatedEventBus=!0):callbacks[key]?"function"==typeof value&&(callbacks[key]=value):scope.options[key]=value}),scope.callbacks=callbacks},!0)}}}),mainModule.controller("as.sortable.sortableGroupController",["$scope","sortableConfig","$document","$window","$helper",function($scope,sortableConfig,$document,$window,$helper){function placeHolderIndex(targetElement){var itemElements,i;if(targetElement.hasClass(sortableConfig.placeHolderClass))return 0;for(itemElements=targetElement.children(),i=0;i<itemElements.length;i+=1)if(angular.element(itemElements[i]).hasClass(sortableConfig.placeHolderClass))return i;return-1}function isPlaceHolderPresent(targetElement){return placeHolderIndex(targetElement)>=0}this.scope=$scope,$scope.toggleAddSelected=function(itemScope){$helper.isSelected($scope.selected,itemScope)?$scope.removeFromSelected(itemScope):$scope.addToSelected(itemScope)},$scope.addToSelected=function(itemScope){var idx=$scope.selected.indexOf(itemScope);-1===idx&&($scope.selected.push(itemScope),$helper.orderSelected($scope.selected)),itemScope.select(),$helper.debounceCall("selectionChanged",$scope.callbacks.selectionChanged,[$scope.selected],1e3)},$scope.removeFromSelected=function(itemScope){var idx=$scope.selected.indexOf(itemScope);idx>-1&&$scope.selected.splice(idx,1),itemScope.unselected(),$helper.debounceCall("selectionChanged",$scope.callbacks.selectionChanged,[$scope.selected],1e3)},$scope.removeAllFromSelected=function(){for(;$scope.selected.length>0;)$scope.removeFromSelected($scope.selected[0])},$scope.expandToSelected=function(itemScope){if(0===$scope.selected.length)$scope.addToSelected(itemScope);else{if($helper.isSelected($scope.selected,itemScope))return;if($helper.allSameParents($scope.selected.concat(itemScope)))for(var sortableElement=itemScope.sortableScope.element[0],maxMinIndexes=$helper.findMaxMinIndex($scope.selected.concat(itemScope)),scopes=$helper.getBetweenScopes(sortableElement,"."+sortableConfig.itemClass,maxMinIndexes.min,maxMinIndexes.max),i=0;i<scopes.length;i++)$scope.addToSelected(scopes[i])}},$scope.selected=[],$scope.dragState={containment:null,dragElementsContainer:null,dragItemsInfo:null,itemPosition:null},$scope.dragging=!1;var scrollableContainer=$document[0].documentElement;$scope.dragStart=function(event){var eventObj=$helper.eventObj(event);if(!$scope.dragging){$scope.dragging=!0,$scope.dragState.dragElementsContainer=angular.element("<div>").addClass(sortableConfig.dragClass),$scope.dragState.containment=angular.element($document[0].body),$scope.dragState.dragItemsInfo=$helper.dragItems($scope.selected);var handleElement=null;handleElement=event.target.classList.contains(sortableConfig.handleClass)?angular.element(event.target):$helper.findAncestor(event.target,"."+sortableConfig.handleClass),$scope.dragState.itemPosition=$helper.positionStarted(eventObj,handleElement,scrollableContainer);for(var i=0;i<$scope.selected.length;i++){var selected=$scope.selected[i],cloning=$helper.isCloning(selected,event.ctrlKey),dragElement=selected.createDragElement(cloning);selected.createPlaceholder(!0),selected.createPlaceElement(!cloning);$scope.dragState.dragElementsContainer.append(dragElement)}$scope.dragState.containment.append($scope.dragState.dragElementsContainer),$helper.movePosition(eventObj,$scope.dragState.dragElementsContainer,$scope.dragState.itemPosition,$scope.dragState.containment,"absolute",scrollableContainer),$scope.$apply(function(){$scope.callbacks.dragStart(eventObj)})}},$scope.dragMove=function(event){var i,selected,eventObj=$helper.eventObj(event),targetX=event.pageX-$document[0].documentElement.scrollLeft,targetY=event.pageY-($window.pageYOffset||$document[0].documentElement.scrollTop),targetElement=angular.element($document[0].elementFromPoint(targetX,targetY)),targetScope=$helper.fetchScope(targetElement,sortableConfig.handleClass);if($helper.movePosition(eventObj,$scope.dragState.dragElementsContainer,$scope.dragState.itemPosition,$scope.dragState.containment,"absolute",scrollableContainer),targetScope&&targetScope.type){if("item"===targetScope.type){targetElement=targetScope.element;var placeholderIndex=placeHolderIndex(targetScope.sortableScope.element);for(i=0;i<$scope.selected.length;i++)selected=$scope.selected[i],0>placeholderIndex?selected.insertBefore(targetElement,targetScope,$scope.dragState.dragItemsInfo):placeholderIndex<=targetScope.index()?selected.insertAfter(targetElement,targetScope,$scope.dragState.dragItemsInfo):selected.insertBefore(targetElement,targetScope,$scope.dragState.dragItemsInfo)}else if("sortable"===targetScope.type&&!$helper.isParent(targetScope.element[0],targetElement[0])&&!isPlaceHolderPresent(targetElement)&&!targetScope.options.clone)for(i=0;i<$scope.selected.length;i++)selected=$scope.selected[i],selected.appendPlaceHolder(targetElement),$scope.dragState.dragItemsInfo.moveTo(targetScope,targetScope.modelValue.length);$scope.$apply(function(){$scope.callbacks.dragMove(eventObj)})}},$scope.dragEnd=function(event,cancel){var eventObj=$helper.eventObj(event);if($scope.dragging){$scope.dragging=!1;for(var i=0;i<$scope.selected.length;i++){var selected=$scope.selected[i];selected.rollbackDragChanges()}$scope.dragState.dragElementsContainer.remove(),$scope.dragState.dragElementsContainer=null,$scope.$apply(function(){if(cancel)$scope.callbacks.dragCancel(eventObj);else{var runCallback=function(){},eventArgs=$scope.dragState.dragItemsInfo.eventArgs();$scope.dragState.dragItemsInfo.allSameParent()?$scope.dragState.dragItemsInfo.isOrderChanged()&&(runCallback=function(){$scope.callbacks.orderChanged(eventArgs)}):runCallback=function(){$scope.callbacks.itemMoved(eventArgs)},$scope.dragState.dragItemsInfo.apply(),runCallback(),$scope.callbacks.dragEnd(eventObj)}$scope.dragState.dragItemsInfo=null,$scope.dragState.itemPosition=null})}}}])}(),function(){"use strict";var mainModule=angular.module("as.sortable");mainModule.controller("as.sortable.sortableController",["$scope",function($scope){this.scope=$scope,$scope.modelValue=null,$scope.callbacks=null,$scope.type="sortable",$scope.options={longTouch:!1},$scope.isDisabled=!1,$scope.insertItem=function(index,itemData){$scope.options.allowDuplicates?$scope.modelValue.splice(index,0,angular.copy(itemData)):$scope.modelValue.splice(index,0,itemData)},$scope.removeItem=function(item){var removedItem=null,index=-1;if(item.$$hashKey){for(var i=0;i<$scope.modelValue.length;i++)if($scope.modelValue[i].$$hashKey===item.$$hashKey){index=i;break}}else index=$scope.modelValue.indexOf(item);return index>-1&&(removedItem=$scope.modelValue.splice(index,1)[0]),removedItem};var scrollState={interval:null,scroll:function(x,y){var newScrollPosition={left:$scope.scrollContainer.scrollLeft+x,top:$scope.scrollContainer.scrollTop+y};$scope.scrollContainer.scroll(newScrollPosition)},setScrollSpeed:function(scrollVector){var x=scrollVector[0],y=scrollVector[1];if(this.interval&&this.cancel(),0!==x||0!==y){var self=this;this.interval=setInterval(function(){self.scroll(x,y)},10),self.scroll(x,y)}},cancel:function(){clearInterval(this.interval),this.interval=null}};$scope.checkScrollContainer=function(event){if($scope.scrollContainer){var scrollContainerRect=$scope.scrollContainer.getBoundingClientRect(),ghostDiv=$scope.groupScope.dragState.dragElementsContainer[0];if(ghostDiv){var ghostRect=ghostDiv.getBoundingClientRect(),threshold=5,scrollSpeed=$scope.scrollSpeed||5,scrollVector=[0,0];ghostRect.right>=scrollContainerRect.right-threshold?scrollVector[0]+=scrollSpeed:ghostRect.left<=scrollContainerRect.left+threshold&&(scrollVector[0]-=scrollSpeed),ghostRect.bottom>=scrollContainerRect.bottom-threshold?scrollVector[1]+=scrollSpeed:ghostRect.top<=scrollContainerRect.top+threshold&&(scrollVector[1]-=scrollSpeed),scrollState.setScrollSpeed(scrollVector)}}},$scope.terminateScroll=function(event){scrollState.cancel()}}]),mainModule.directive("asSortable",function(){return{require:["?ngModel","^asSortableGroup"],restrict:"A",scope:!0,controller:"as.sortable.sortableController",link:function(scope,element,attrs,ctrl){var ngModel;ngModel=ctrl[0],scope.groupScope=ctrl[1].scope,ngModel&&(ngModel.$render=function(){scope.modelValue=ngModel.$modelValue},scope.element=element,element.data("_scope",scope),scope.$watch(attrs.asSortable,function(newVal,oldVal){angular.forEach(newVal,function(value,key){scope.options[key]=value})},!0),angular.isDefined(attrs.isDisabled)&&scope.$watch(attrs.isDisabled,function(newVal,oldVal){angular.isUndefined(newVal)||(scope.isDisabled=newVal)},!0),scope.$watch(attrs.asRowNumber,function(newVal,oldVal){scope.rowIndex=newVal}),scope.$watch(attrs.asScrollContainer,function(newVal,oldVal){scope.scrollContainer=newVal}),scope.$watch(attrs.asScrollSpeed,function(newVal,oldVal){scope.scrollSpeed=parseInt(newVal)}))}}})}(),function(){"use strict";var mainModule=angular.module("as.sortable");mainModule.controller("as.sortable.sortableItemHandleController",["$scope",function($scope){this.scope=$scope,$scope.itemScope=null,$scope.type="handle"}]),mainModule.directive("asSortableItemHandle",["sortableConfig","$helper","$window","$document","$timeout",function(sortableConfig,$helper,$window,$document,$timeout){return{require:"^asSortableItem",scope:!0,restrict:"A",controller:"as.sortable.sortableItemHandleController",link:function(scope,element,attrs,itemController){var dragListen,dragStart,dragMove,dragEnd,dragCancel,isDraggable,bindDrag,unbindDrag,bindEvents,unBindEvents,hasTouch,isIOS,longTouchStart,longTouchCancel,longTouchTimer,dragHandled,escapeListen,isDisabled=!1,isLongTouch=!1;hasTouch="ontouchstart"in $window,isIOS=/iPad|iPhone|iPod/.test($window.navigator.userAgent)&&!$window.MSStream,sortableConfig.handleClass&&element.addClass(sortableConfig.handleClass),scope.itemScope=itemController.scope,element.data("_scope",scope),scope.$watchGroup(["sortableScope.isDisabled","sortableScope.options.longTouch"],function(newValues){isDisabled!==newValues[0]?(isDisabled=newValues[0],isDisabled?unbindDrag():bindDrag()):isLongTouch!==newValues[1]?(isLongTouch=newValues[1],unbindDrag(),bindDrag()):bindDrag()}),scope.$on("$destroy",function(){angular.element($document[0].body).unbind("keydown",escapeListen)}),dragListen=function(event){var startPosition,unbindMoveListen=function(){angular.element($document).unbind("mousemove",moveListen),angular.element($document).unbind("touchmove",moveListen),element.unbind("mouseup",unbindMoveListen),element.unbind("touchend",unbindMoveListen),element.unbind("touchcancel",unbindMoveListen)},moveListen=function(e){e.preventDefault();var eventObj=$helper.eventObj(e);startPosition||(startPosition={clientX:eventObj.clientX,clientY:eventObj.clientY}),Math.abs(eventObj.clientX-startPosition.clientX)+Math.abs(eventObj.clientY-startPosition.clientY)>10&&(unbindMoveListen(),dragStart(event))};angular.element($document).bind("mousemove",moveListen),angular.element($document).bind("touchmove",moveListen),element.bind("mouseup",unbindMoveListen),element.bind("touchend",unbindMoveListen),element.bind("touchcancel",unbindMoveListen),event.stopPropagation()},dragStart=function(event){(hasTouch||2!==event.button&&3!==event.which)&&(hasTouch&&$helper.isTouchInvalid(event)||!dragHandled&&isDraggable(event)&&(dragHandled=!0,event.preventDefault(),scope.itemScope.sortableScope.groupScope.dragStart(event),bindEvents()))},isDraggable=function(event){var elementClicked,sourceScope,isDraggable;for(elementClicked=angular.element(event.target),sourceScope=$helper.fetchScope(elementClicked),isDraggable=sourceScope&&"handle"===sourceScope.type;isDraggable&&elementClicked[0]!==element[0];)$helper.noDrag(elementClicked)&&(isDraggable=!1),elementClicked=elementClicked.parent();return isDraggable},dragMove=function(event){hasTouch&&$helper.isTouchInvalid(event)||dragHandled&&(event.preventDefault(),scope.itemScope.sortableScope.groupScope.dragMove(event),scope.itemScope.sortableScope.checkScrollContainer(event))},dragEnd=function(event){dragHandled&&(event.preventDefault(),scope.itemScope.sortableScope.groupScope.dragEnd(event),scope.itemScope.sortableScope.terminateScroll(event),dragHandled=!1,unBindEvents())},dragCancel=function(event){dragHandled&&(event.preventDefault(),scope.itemScope.sortableScope.groupScope.dragEnd(event,!0),unBindEvents())},bindDrag=function(){hasTouch&&(isLongTouch?isIOS?(element.bind("touchstart",longTouchStart),element.bind("touchend",longTouchCancel),element.bind("touchmove",longTouchCancel)):element.bind("contextmenu",dragListen):element.bind("touchstart",dragListen)),element.bind("mousedown",dragListen)},unbindDrag=function(){element.unbind("touchstart",longTouchStart),element.unbind("touchend",longTouchCancel),element.unbind("touchmove",longTouchCancel),element.unbind("contextmenu",dragListen),element.unbind("touchstart",dragListen),element.unbind("mousedown",dragListen)},longTouchStart=function(event){longTouchTimer=$timeout(function(){dragListen(event)},500)},longTouchCancel=function(){$timeout.cancel(longTouchTimer)},escapeListen=function(event){27===event.keyCode&&dragCancel(event)},angular.element($document[0].body).bind("keydown",escapeListen),bindEvents=function(){angular.element($document).bind("touchmove",dragMove),angular.element($document).bind("touchend",dragEnd),angular.element($document).bind("touchcancel",dragCancel),angular.element($document).bind("mousemove",dragMove),angular.element($document).bind("mouseup",dragEnd)},unBindEvents=function(){angular.element($document).unbind("touchend",dragEnd),angular.element($document).unbind("touchcancel",dragCancel),angular.element($document).unbind("touchmove",dragMove),angular.element($document).unbind("mouseup",dragEnd),angular.element($document).unbind("mousemove",dragMove)}}}}])}(),function(){"use strict";var mainModule=angular.module("as.sortable");mainModule.controller("as.sortable.sortableItemController",["$scope","sortableConfig","$helper","$document","$timeout",function($scope,sortableConfig,$helper,$document,$timeout){this.scope=$scope,$scope.sortableScope=null,$scope.modelValue=null,$scope.type="item",$scope.index=function(){return $scope.$index},$scope.overAllIndex=function(){return{row:$scope.sortableScope.rowIndex,column:$scope.$index}},$scope.itemData=function(){return $scope.sortableScope.modelValue[$scope.$index]},$scope.select=function(){$scope.element.addClass(sortableConfig.selectedClass)},$scope.unselected=function(){$scope.element.removeClass(sortableConfig.selectedClass)},$timeout(function(){$helper.isSelected($scope.sortableScope.groupScope.selected,$scope,$scope.modelValue.$$hashKey)&&$scope.select()},0);var placeHolder=null,placeElement=null;$scope.createDragElement=function(clone){return clone?$scope.element.clone():$scope.element},$scope.createPlaceholder=function(append){return placeHolder="function"==typeof $scope.sortableScope.options.placeholder?angular.element($scope.sortableScope.options.placeholder($scope)):"string"==typeof $scope.sortableScope.options.placeholder?angular.element($scope.sortableScope.options.placeholder):angular.element($document[0].createElement($scope.element.prop("tagName"))),placeHolder.addClass(sortableConfig.placeHolderClass).addClass($scope.sortableScope.options.additionalPlaceholderClass),placeHolder.css("width",$helper.width($scope.element)+"px"),placeHolder.css("height",$helper.height($scope.element)+"px"),append&&!$scope.sortableScope.options.clone&&$scope.element.after(placeHolder),placeHolder},$scope.createPlaceElement=function(append){var tagName=$scope.element.prop("tagName");return placeElement=angular.element($document[0].createElement(tagName)),sortableConfig.hiddenClass&&placeElement.addClass(sortableConfig.hiddenClass),append&&$scope.element.after(placeElement),placeElement},$scope.insertBefore=function(targetElement,targetScope,dragItemsInfo){"table-row"!==placeHolder.css("display")&&placeHolder.css("display","block"),targetScope.sortableScope.options.clone||(targetElement[0].parentNode.insertBefore(placeHolder[0],targetElement[0]),dragItemsInfo.moveTo(targetScope.sortableScope,targetScope.index()))},$scope.insertAfter=function(targetElement,targetScope,dragItemsInfo){"table-row"!==placeHolder.css("display")&&placeHolder.css("display","block"),targetScope.sortableScope.options.clone||(targetElement.after(placeHolder),dragItemsInfo.moveTo(targetScope.sortableScope,targetScope.index()+1))},$scope.appendPlaceHolder=function(targetElement){targetElement[0].appendChild(placeHolder[0])},$scope.rollbackDragChanges=function(){$scope.sortableScope.cloning||placeElement.replaceWith($scope.element),placeHolder.remove()}}]),mainModule.directive("asSortableItem",["sortableConfig",function(sortableConfig){return{require:["^asSortable","?ngModel"],restrict:"A",controller:"as.sortable.sortableItemController",link:function(scope,element,attrs,ctrl){var sortableController=ctrl[0],ngModelController=ctrl[1];sortableConfig.itemClass&&element.addClass(sortableConfig.itemClass),scope.sortableScope=sortableController.scope,ngModelController?ngModelController.$render=function(){scope.modelValue=ngModelController.$modelValue}:scope.modelValue=sortableController.scope.modelValue[scope.$index],scope.element=element,element.data("_scope",scope)}}}])}(),function(){"use strict";var mainModule=angular.module("as.sortable");mainModule.directive("asSortableItemSelectable",["$timeout","$helper",function($timeout,$helper){return{require:"^asSortableItem",scope:!0,restrict:"A",controller:"as.sortable.sortableItemHandleController",link:function(scope,element,attrs,itemController){scope.itemScope=itemController.scope;var startPosition={},threshold=10,groupScope=null;$timeout(function(){groupScope=scope.itemScope.sortableScope.groupScope},0);var handlePointerDown=function(e){startPosition.initiated=!0,startPosition.clientX=e.clientX,startPosition.clientY=e.clientY,e.ctrlKey||e.metaKey||e.shiftKey||$helper.isSelected(groupScope.selected,scope.itemScope)||scope.$apply(function(){groupScope.removeAllFromSelected(),groupScope.addToSelected(scope.itemScope)})},handlePointerUp=function(e){startPosition.initiated&&(e.clientX<=startPosition.clientX+threshold&&e.clientX>=startPosition.clientX-threshold&&e.clientY<=startPosition.clientY+threshold&&e.clientY>=startPosition.clientY-threshold&&scope.$apply(function(){e.shiftKey?groupScope.expandToSelected(scope.itemScope):groupScope.addToSelected(scope.itemScope)}),startPosition.initiated=!1)};window.PointerEvent?(element.on("pointerdown",handlePointerDown),element.on("pointerup",handlePointerUp)):(element.on("mousedown",handlePointerDown),element.on("mouseup",handlePointerUp),element.on("touchstart",handlePointerDown),element.on("touchend",handlePointerUp))}}}])}();